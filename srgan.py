import tensorflow as tf
from tensorflow import keras
from keras.layers  import *
from tensorflow.keras.models import Model

def build_generator(lr_shape=(150, 112, 3)):
    def residual_block(x_input):
        x = Conv2D(64, kernel_size=3, padding="same")(x_input)
        x = BatchNormalization(momentum=0.8)(x)
        x = PReLU(shared_axes=[1, 2])(x)
        x = Conv2D(64, kernel_size=3, padding="same")(x)
        x = BatchNormalization(momentum=0.8)(x)
        return Add()([x_input, x])

    inputs = Input(shape=lr_shape)
    x = Conv2D(64, kernel_size=9, padding="same")(inputs)
    x = PReLU(shared_axes=[1, 2])(x)
    skip = x

    # Residual blocks
    for _ in range(16):
        x = residual_block(x)

    x = Conv2D(64, kernel_size=3, padding="same")(x)
    x = BatchNormalization(momentum=0.8)(x)
    x = Add()([x, skip])

    x = UpSampling2D(size=2)(x)
    x = Conv2D(256, kernel_size=3, padding="same")(x)
    x = PReLU(shared_axes=[1, 2])(x)

    outputs = Conv2D(3, kernel_size=9, activation="tanh", padding="same")(x)
    model = Model(inputs, outputs)
    return model


def build_discriminator(hr_shape=(300, 224, 3)):
    def disc_block(x, filters, strides=1, bn=True):
        x = Conv2D(filters, kernel_size=3, strides=strides, padding='same')(x)
        x = LeakyReLU(alpha=0.2)(x)
        if bn:
            x = BatchNormalization(momentum=0.8)(x)
        return x

    inputs = Input(shape=hr_shape)
    x = disc_block(inputs, 64, bn=False)
    x = disc_block(x, 64, strides=2)
    x = disc_block(x, 128)
    x = disc_block(x, 128, strides=2)
    x = disc_block(x, 256)
    x = disc_block(x, 256, strides=2)
    x = disc_block(x, 512)
    x = disc_block(x, 512, strides=2)
    x = Flatten()(x)
    x = Dense(1024)(x)
    x = LeakyReLU(alpha=0.2)(x)
    x = Dense(1, activation='sigmoid')(x)
    return Model(inputs, x)

# Build and compile
# generator = build_generator()
# generator.compile(optimizer="adam", loss="mse")
# generator.summary()

"""
Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                 ┃ Output Shape              ┃         Param # ┃ Connected to              ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ input_layer (InputLayer)     │ (None, 150, 112, 3)       │               0 │ -                         │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d (Conv2D)              │ (None, 150, 112, 64)      │          15,616 │ input_layer[0][0]         │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ p_re_lu (PReLU)              │ (None, 150, 112, 64)      │              64 │ conv2d[0][0]              │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_1 (Conv2D)            │ (None, 150, 112, 64)      │          36,928 │ p_re_lu[0][0]             │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ batch_normalization          │ (None, 150, 112, 64)      │             256 │ conv2d_1[0][0]            │
│ (BatchNormalization)         │                           │                 │                           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ p_re_lu_1 (PReLU)            │ (None, 150, 112, 64)      │              64 │ batch_normalization[0][0] │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_2 (Conv2D)            │ (None, 150, 112, 64)      │          36,928 │ p_re_lu_1[0][0]           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ batch_normalization_1        │ (None, 150, 112, 64)      │             256 │ conv2d_2[0][0]            │
│ (BatchNormalization)         │                           │                 │                           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ add (Add)                    │ (None, 150, 112, 64)      │               0 │ p_re_lu[0][0],            │
│                              │                           │                 │ batch_normalization_1[0]… │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_3 (Conv2D)            │ (None, 150, 112, 64)      │          36,928 │ add[0][0]                 │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ batch_normalization_2        │ (None, 150, 112, 64)      │             256 │ conv2d_3[0][0]            │
│ (BatchNormalization)         │                           │                 │                           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ p_re_lu_2 (PReLU)            │ (None, 150, 112, 64)      │              64 │ batch_normalization_2[0]… │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_4 (Conv2D)            │ (None, 150, 112, 64)      │          36,928 │ p_re_lu_2[0][0]           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ batch_normalization_3        │ (None, 150, 112, 64)      │             256 │ conv2d_4[0][0]            │
│ (BatchNormalization)         │                           │                 │                           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ add_1 (Add)                  │ (None, 150, 112, 64)      │               0 │ add[0][0],                │
│                              │                           │                 │ batch_normalization_3[0]… │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_5 (Conv2D)            │ (None, 150, 112, 64)      │          36,928 │ add_1[0][0]               │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ batch_normalization_4        │ (None, 150, 112, 64)      │             256 │ conv2d_5[0][0]            │
│ (BatchNormalization)         │                           │                 │                           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ p_re_lu_3 (PReLU)            │ (None, 150, 112, 64)      │              64 │ batch_normalization_4[0]… │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_6 (Conv2D)            │ (None, 150, 112, 64)      │          36,928 │ p_re_lu_3[0][0]           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ batch_normalization_5        │ (None, 150, 112, 64)      │             256 │ conv2d_6[0][0]            │
│ (BatchNormalization)         │                           │                 │                           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ add_2 (Add)                  │ (None, 150, 112, 64)      │               0 │ add_1[0][0],              │
│                              │                           │                 │ batch_normalization_5[0]… │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_7 (Conv2D)            │ (None, 150, 112, 64)      │          36,928 │ add_2[0][0]               │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ batch_normalization_6        │ (None, 150, 112, 64)      │             256 │ conv2d_7[0][0]            │
│ (BatchNormalization)         │                           │                 │                           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ p_re_lu_4 (PReLU)            │ (None, 150, 112, 64)      │              64 │ batch_normalization_6[0]… │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_8 (Conv2D)            │ (None, 150, 112, 64)      │          36,928 │ p_re_lu_4[0][0]           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ batch_normalization_7        │ (None, 150, 112, 64)      │             256 │ conv2d_8[0][0]            │
│ (BatchNormalization)         │                           │                 │                           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ add_3 (Add)                  │ (None, 150, 112, 64)      │               0 │ add_2[0][0],              │
│                              │                           │                 │ batch_normalization_7[0]… │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_9 (Conv2D)            │ (None, 150, 112, 64)      │          36,928 │ add_3[0][0]               │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ batch_normalization_8        │ (None, 150, 112, 64)      │             256 │ conv2d_9[0][0]            │
│ (BatchNormalization)         │                           │                 │                           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ p_re_lu_5 (PReLU)            │ (None, 150, 112, 64)      │              64 │ batch_normalization_8[0]… │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_10 (Conv2D)           │ (None, 150, 112, 64)      │          36,928 │ p_re_lu_5[0][0]           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ batch_normalization_9        │ (None, 150, 112, 64)      │             256 │ conv2d_10[0][0]           │
│ (BatchNormalization)         │                           │                 │                           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ add_4 (Add)                  │ (None, 150, 112, 64)      │               0 │ add_3[0][0],              │
│                              │                           │                 │ batch_normalization_9[0]… │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_11 (Conv2D)           │ (None, 150, 112, 64)      │          36,928 │ add_4[0][0]               │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ batch_normalization_10       │ (None, 150, 112, 64)      │             256 │ conv2d_11[0][0]           │
│ (BatchNormalization)         │                           │                 │                           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ p_re_lu_6 (PReLU)            │ (None, 150, 112, 64)      │              64 │ batch_normalization_10[0… │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_12 (Conv2D)           │ (None, 150, 112, 64)      │          36,928 │ p_re_lu_6[0][0]           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ batch_normalization_11       │ (None, 150, 112, 64)      │             256 │ conv2d_12[0][0]           │
│ (BatchNormalization)         │                           │                 │                           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ add_5 (Add)                  │ (None, 150, 112, 64)      │               0 │ add_4[0][0],              │
│                              │                           │                 │ batch_normalization_11[0… │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_13 (Conv2D)           │ (None, 150, 112, 64)      │          36,928 │ add_5[0][0]               │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ batch_normalization_12       │ (None, 150, 112, 64)      │             256 │ conv2d_13[0][0]           │
│ (BatchNormalization)         │                           │                 │                           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ p_re_lu_7 (PReLU)            │ (None, 150, 112, 64)      │              64 │ batch_normalization_12[0… │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_14 (Conv2D)           │ (None, 150, 112, 64)      │          36,928 │ p_re_lu_7[0][0]           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ batch_normalization_13       │ (None, 150, 112, 64)      │             256 │ conv2d_14[0][0]           │
│ (BatchNormalization)         │                           │                 │                           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ add_6 (Add)                  │ (None, 150, 112, 64)      │               0 │ add_5[0][0],              │
│                              │                           │                 │ batch_normalization_13[0… │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_15 (Conv2D)           │ (None, 150, 112, 64)      │          36,928 │ add_6[0][0]               │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ batch_normalization_14       │ (None, 150, 112, 64)      │             256 │ conv2d_15[0][0]           │
│ (BatchNormalization)         │                           │                 │                           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ p_re_lu_8 (PReLU)            │ (None, 150, 112, 64)      │              64 │ batch_normalization_14[0… │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_16 (Conv2D)           │ (None, 150, 112, 64)      │          36,928 │ p_re_lu_8[0][0]           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ batch_normalization_15       │ (None, 150, 112, 64)      │             256 │ conv2d_16[0][0]           │
│ (BatchNormalization)         │                           │                 │                           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ add_7 (Add)                  │ (None, 150, 112, 64)      │               0 │ add_6[0][0],              │
│                              │                           │                 │ batch_normalization_15[0… │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_17 (Conv2D)           │ (None, 150, 112, 64)      │          36,928 │ add_7[0][0]               │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ batch_normalization_16       │ (None, 150, 112, 64)      │             256 │ conv2d_17[0][0]           │
│ (BatchNormalization)         │                           │                 │                           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ p_re_lu_9 (PReLU)            │ (None, 150, 112, 64)      │              64 │ batch_normalization_16[0… │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_18 (Conv2D)           │ (None, 150, 112, 64)      │          36,928 │ p_re_lu_9[0][0]           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ batch_normalization_17       │ (None, 150, 112, 64)      │             256 │ conv2d_18[0][0]           │
│ (BatchNormalization)         │                           │                 │                           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ add_8 (Add)                  │ (None, 150, 112, 64)      │               0 │ add_7[0][0],              │
│                              │                           │                 │ batch_normalization_17[0… │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_19 (Conv2D)           │ (None, 150, 112, 64)      │          36,928 │ add_8[0][0]               │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ batch_normalization_18       │ (None, 150, 112, 64)      │             256 │ conv2d_19[0][0]           │
│ (BatchNormalization)         │                           │                 │                           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ p_re_lu_10 (PReLU)           │ (None, 150, 112, 64)      │              64 │ batch_normalization_18[0… │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_20 (Conv2D)           │ (None, 150, 112, 64)      │          36,928 │ p_re_lu_10[0][0]          │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ batch_normalization_19       │ (None, 150, 112, 64)      │             256 │ conv2d_20[0][0]           │
│ (BatchNormalization)         │                           │                 │                           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ add_9 (Add)                  │ (None, 150, 112, 64)      │               0 │ add_8[0][0],              │
│                              │                           │                 │ batch_normalization_19[0… │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_21 (Conv2D)           │ (None, 150, 112, 64)      │          36,928 │ add_9[0][0]               │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ batch_normalization_20       │ (None, 150, 112, 64)      │             256 │ conv2d_21[0][0]           │
│ (BatchNormalization)         │                           │                 │                           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ p_re_lu_11 (PReLU)           │ (None, 150, 112, 64)      │              64 │ batch_normalization_20[0… │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_22 (Conv2D)           │ (None, 150, 112, 64)      │          36,928 │ p_re_lu_11[0][0]          │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ batch_normalization_21       │ (None, 150, 112, 64)      │             256 │ conv2d_22[0][0]           │
│ (BatchNormalization)         │                           │                 │                           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ add_10 (Add)                 │ (None, 150, 112, 64)      │               0 │ add_9[0][0],              │
│                              │                           │                 │ batch_normalization_21[0… │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_23 (Conv2D)           │ (None, 150, 112, 64)      │          36,928 │ add_10[0][0]              │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ batch_normalization_22       │ (None, 150, 112, 64)      │             256 │ conv2d_23[0][0]           │
│ (BatchNormalization)         │                           │                 │                           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ p_re_lu_12 (PReLU)           │ (None, 150, 112, 64)      │              64 │ batch_normalization_22[0… │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_24 (Conv2D)           │ (None, 150, 112, 64)      │          36,928 │ p_re_lu_12[0][0]          │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ batch_normalization_23       │ (None, 150, 112, 64)      │             256 │ conv2d_24[0][0]           │
│ (BatchNormalization)         │                           │                 │                           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ add_11 (Add)                 │ (None, 150, 112, 64)      │               0 │ add_10[0][0],             │
│                              │                           │                 │ batch_normalization_23[0… │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_25 (Conv2D)           │ (None, 150, 112, 64)      │          36,928 │ add_11[0][0]              │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ batch_normalization_24       │ (None, 150, 112, 64)      │             256 │ conv2d_25[0][0]           │
│ (BatchNormalization)         │                           │                 │                           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ p_re_lu_13 (PReLU)           │ (None, 150, 112, 64)      │              64 │ batch_normalization_24[0… │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_26 (Conv2D)           │ (None, 150, 112, 64)      │          36,928 │ p_re_lu_13[0][0]          │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ batch_normalization_25       │ (None, 150, 112, 64)      │             256 │ conv2d_26[0][0]           │
│ (BatchNormalization)         │                           │                 │                           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ add_12 (Add)                 │ (None, 150, 112, 64)      │               0 │ add_11[0][0],             │
│                              │                           │                 │ batch_normalization_25[0… │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_27 (Conv2D)           │ (None, 150, 112, 64)      │          36,928 │ add_12[0][0]              │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ batch_normalization_26       │ (None, 150, 112, 64)      │             256 │ conv2d_27[0][0]           │
│ (BatchNormalization)         │                           │                 │                           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ p_re_lu_14 (PReLU)           │ (None, 150, 112, 64)      │              64 │ batch_normalization_26[0… │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_28 (Conv2D)           │ (None, 150, 112, 64)      │          36,928 │ p_re_lu_14[0][0]          │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ batch_normalization_27       │ (None, 150, 112, 64)      │             256 │ conv2d_28[0][0]           │
│ (BatchNormalization)         │                           │                 │                           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ add_13 (Add)                 │ (None, 150, 112, 64)      │               0 │ add_12[0][0],             │
│                              │                           │                 │ batch_normalization_27[0… │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_29 (Conv2D)           │ (None, 150, 112, 64)      │          36,928 │ add_13[0][0]              │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ batch_normalization_28       │ (None, 150, 112, 64)      │             256 │ conv2d_29[0][0]           │
│ (BatchNormalization)         │                           │                 │                           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ p_re_lu_15 (PReLU)           │ (None, 150, 112, 64)      │              64 │ batch_normalization_28[0… │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_30 (Conv2D)           │ (None, 150, 112, 64)      │          36,928 │ p_re_lu_15[0][0]          │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ batch_normalization_29       │ (None, 150, 112, 64)      │             256 │ conv2d_30[0][0]           │
│ (BatchNormalization)         │                           │                 │                           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ add_14 (Add)                 │ (None, 150, 112, 64)      │               0 │ add_13[0][0],             │
│                              │                           │                 │ batch_normalization_29[0… │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_31 (Conv2D)           │ (None, 150, 112, 64)      │          36,928 │ add_14[0][0]              │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ batch_normalization_30       │ (None, 150, 112, 64)      │             256 │ conv2d_31[0][0]           │
│ (BatchNormalization)         │                           │                 │                           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ p_re_lu_16 (PReLU)           │ (None, 150, 112, 64)      │              64 │ batch_normalization_30[0… │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_32 (Conv2D)           │ (None, 150, 112, 64)      │          36,928 │ p_re_lu_16[0][0]          │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ batch_normalization_31       │ (None, 150, 112, 64)      │             256 │ conv2d_32[0][0]           │
│ (BatchNormalization)         │                           │                 │                           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ add_15 (Add)                 │ (None, 150, 112, 64)      │               0 │ add_14[0][0],             │
│                              │                           │                 │ batch_normalization_31[0… │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_33 (Conv2D)           │ (None, 150, 112, 64)      │          36,928 │ add_15[0][0]              │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ batch_normalization_32       │ (None, 150, 112, 64)      │             256 │ conv2d_33[0][0]           │
│ (BatchNormalization)         │                           │                 │                           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ add_16 (Add)                 │ (None, 150, 112, 64)      │               0 │ batch_normalization_32[0… │
│                              │                           │                 │ p_re_lu[0][0]             │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ up_sampling2d (UpSampling2D) │ (None, 300, 224, 64)      │               0 │ add_16[0][0]              │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_34 (Conv2D)           │ (None, 300, 224, 256)     │         147,712 │ up_sampling2d[0][0]       │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ p_re_lu_17 (PReLU)           │ (None, 300, 224, 256)     │             256 │ conv2d_34[0][0]           │
├──────────────────────────────┼───────────────────────────┼─────────────────┼───────────────────────────┤
│ conv2d_35 (Conv2D)           │ (None, 300, 224, 3)       │          62,211 │ p_re_lu_17[0][0]          │
└──────────────────────────────┴───────────────────────────┴─────────────────┴───────────────────────────┘
 Total params: 1,453,955 (5.55 MB)
 Trainable params: 1,449,731 (5.53 MB)
 Non-trainable params: 4,224 (16.50 KB)
"""
